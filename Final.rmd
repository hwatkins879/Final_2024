---
title: "Covid91 vaccine study Final2024"
author: "Hailey Watkins-Oliver!"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="finalSumr2024.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
FinalData$treatment <- relevel(FinalData$treatment,ref="placebo")
#FinalData$infected <- relevel(FinalData$infected,ref="OK")
guy = filter(FinalData, sex =="M")
gal = filter(FinalData, sex =="F")
gay = filter(FinalData, LGBTQ =="gay")
Druguser = filter(FinalData, DrugUser =="yes")
```

# Introduction

A new  preventative vaccine (covid921) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

## Males

```{r}
Males <- guy %>%
  group_by(infected,treatment) %>%
  summarize(count=n()) %>% 
  mutate(prcnt=count/sum(count))

basicC <- ggplot(Males,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

basicCC <- ggplot(Males,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

The population of men (males) and their association to COVID-19 by vaccination or placebo are represented in this plot. 


Plotting indicates that COVID-19 was significantly lower in those who received the immunization than in those who received a placebo. The size difference between the placebo and the vaccination is roughly 3:1.

### Numerical results

```{r}
table1 <- xtabs(~infected + treatment, data=guy)
rowPerc(table1)
colPerc(table1)
```

The percentage of boys who contracted COVID-19 after receiving the immunization was a low 26.2%. 73.8% of those who are not vaccinated contract COVID-19. The vaccine appears to have a bright future.


### Inferential 



```{r}
chisq.test(table1)
chisqtestGC(table1)
guysfish <- fisher.test(table1)
guysfish
```


The output of the Fisher's Exact test is the data that should be closely monitored among all of these findings. The p-value, which is 2.2e-16 0.00000000000000022, is quite small. This figure indicates that it is unlikely that these outcomes happened by accident.

When compared to a placebo, our odds ratio of roughly 2.8 indicates that this vaccine is beneficial in halting COVID-19.
```{r}
effect <- guysfish$p.value/(guysfish$p.value +1)
effectivenessguy = guysfish$estimate/(guysfish$estimate +1)*100
print(effectivenessguy)
```

```{r}
low=(guysfish$conf.int[1]/(guysfish$conf.int[1] +1))*100
hi=(guysfish$conf.int[2]/(guysfish$conf.int[2] +1))*100
options(digits=2)
```

## Effectiveness Confidence Interval `r low`  to `r hi`


The odds ratio of the males with vaccines vs those with placebos has a ratio greater than 70 meaning we have a effective vaccine for males. 

## Females
### Barplot

```{r}
Females <- gal %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))

basicC <- ggplot(Females,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

basicCC <- ggplot(Females,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```
The population of gals (females) and their association with the spread of COVID-19 through vaccination or placebo are depicted in this plot. 

Comparing the Covid-19 vaccination to the placebo, it has been demonstrated that the ratio of infected individuals is 2:1. Approximately 36% of females who received a vaccine appear to have contracted the infection, compared to roughly 65% of females who received a placebo.

### Numerical results

```{r}
table1 <- xtabs(~infected + treatment, data=gal)
rowPerc(table1)
colPerc(table1)
```

35% of females who received the immunization contracted COVID-19, compared to 65% of those who received a placebo. This does indicate a ratio of roughly 2:1.

### Inferential 

```{r}
chisq.test(table1)
chisqtestGC(table1)
galsfish <- fisher.test(table1)
galsfish
```



The output of the Fisher's Exact test is the data that should be closely monitored among all of these findings. At 0.00000001, the p-value shown above is incredibly minuscule. This is a very small number. The null hypothesis can be rejected in favor of the alternative as this number indicates that the results are unlikely to have happened by accident.


The odds ratio is 1.9, which is a respectable ratio for effectiveness, according to the Fishers' Exact Test. 

```{r}
effect <- galsfish$p.value/(galsfish$p.value +1)
effectivenessgal = galsfish$estimate/(galsfish$estimate +1)*100
print(effectivenessgal)
```

```{r}
low=(galsfish$conf.int[1]/(galsfish$conf.int[1] +1))*100
hi=(galsfish$conf.int[2]/(galsfish$conf.int[2] +1))*100
options(digits=2)
```

## Effectiveness Confidence Interval `r low`  to `r hi`


The girls' efficacy on the confidence interval is 65. This is above 50%, indicating that the vaccine is fairly efficient; however, as compared to females, males are more effective, as evidenced by their 74 confidence interval. 

## LGBTQ
### Barplot

```{r}
LGBTQ <- gay %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(LGBTQ,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(LGBTQ,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

About 20% of gay people who received the vaccine became infected, while 80% of people who received a placebo became infected. This is roughly a 4:1 ratio.



## Druggies


# Overall Results and Conclusions